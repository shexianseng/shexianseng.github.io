<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>车辆认证</title>
    <link rel="stylesheet" href="./css/index.css">
    <!-- <link rel="stylesheet" href="./css/public.css"> -->
    <script src="./js/jquery-1.8.3.min.js"></script>
    <script src="./js/rem.js"></script>
</head>

<body>
    <div class="box inspect">
        <div class="nav">
            <a><img src="./images/left.png" alt=""></a>
            <h2><strong>车辆认证</strong></h2>
            <a></a>
        </div>
        <div class="IDcard">
            <div class="IDcard-list clrz-list">
                <h2>车辆信息</h2>
                <ul>
                    <li>
                        <h2 class="IDcard-list-h2">牵引车行驶证主页</h2>
                        <div class="IDcard-list-div upload-div">
                            <img src="./images/sfzzm.png" alt="">
                            <div class="img-sc">
                                <img src="./images/xj.png" alt="">
                                <span>图片上传</span>
                            </div>
                            <!-- <img onclick="deletImg(this)" src="./images/gb1.png" alt=""> -->
                        </div>
                        <div class="clrz-bg">
                            <div class="clrz-div">
                                <ul class="clrz-ul">
                                    <li class="pz"><input type="file" accept="image/*" mutiple="mutiple" capture="camera"
                                            onchange="checkImg(this)" /> <a>拍照</a> </li>
                                    <li class="xc"><input type="file" id="file" accept="image/*"
                                            onchange="checkImg(this)"><a>从相册选择</a></li>
                                </ul>
                                <a class="clrz-qx">取消</a>
                            </div>
                        </div>
                    </li>
                    <li>
                        <h2 class="IDcard-list-h2">牵引车行驶证副页</h2>
                        <div class="IDcard-list-div upload-div">
                            <img src="./images/sfzzm.png" alt="">
                            <div class="img-sc">
                                <img src="./images/xj.png" alt="">
                                <span>图片上传</span>
                            </div>
                            <!-- <img onclick="deletImg(this)" src="./images/gb1.png" alt=""> -->
                        </div>
                        <div class="clrz-bg">
                            <div class="clrz-div">
                                <ul class="clrz-ul">
                                    <li class="pz"><input type="file" accept="image/*" mutiple="mutiple" capture="camera"
                                            onchange="checkImg(this)" /> <a>拍照</a> </li>
                                    <li class="xc"><input type="file" id="file" accept="image/*"
                                            onchange="checkImg(this)"><a>从相册选择</a></li>
                                </ul>
                                <a class="clrz-qx">取消</a>
                            </div>
                        </div>
                    </li>
                    <li>
                        <h2 class="IDcard-list-h2">牵引车、挂车行驶证</h2>
                        <div class="IDcard-list-div upload-div">
                            <img src="./images/sfzzm.png" alt="">
                            <div class="img-sc">
                                <img src="./images/xj.png" alt="">
                                <span>图片上传</span>
                            </div>
                            <!-- <img onclick="deletImg(this)" src="./images/gb1.png" alt=""> -->
                        </div>
                        <div class="clrz-bg">
                            <div class="clrz-div">
                                <ul class="clrz-ul">
                                    <li class="pz"><input type="file" accept="image/*" mutiple="mutiple" capture="camera"
                                            onchange="checkImg(this)" /> <a>拍照</a> </li>
                                    <li class="xc"><input type="file" id="file" accept="image/*"
                                            onchange="checkImg(this)"><a>从相册选择</a></li>
                                </ul>
                                <a class="clrz-qx">取消</a>
                            </div>
                        </div>
                    </li>
                    <li>
                        <h2 class="IDcard-list-h2">牵引车、挂车运输证</h2>
                        <div class="IDcard-list-div upload-div">
                            <img src="./images/sfzzm.png" alt="">
                            <div class="img-sc">
                                <img src="./images/xj.png" alt="">
                                <span>图片上传</span>
                            </div>
                            <!-- <img onclick="deletImg(this)" src="./images/gb1.png" alt=""> -->
                        </div>
                        <div class="clrz-bg">
                            <div class="clrz-div">
                                <ul class="clrz-ul">
                                    <li class="pz"><input type="file" accept="image/*" mutiple="mutiple" capture="camera"
                                            onchange="checkImg(this)" /> <a>拍照</a> </li>
                                    <li class="xc"><input type="file" id="file" accept="image/*"
                                            onchange="checkImg(this)"><a>从相册选择</a></li>
                                </ul>
                                <a class="clrz-qx">取消</a>
                            </div>
                        </div>
                    </li>
                    <li>
                        <h2 class="IDcard-list-h2">车辆照片</h2>
                        <div class="IDcard-list-div upload-div">
                            <img src="./images/sfzzm.png" alt="">
                            <div class="img-sc">
                                <img src="./images/xj.png" alt="">
                                <span>图片上传</span>
                            </div>
                            <!-- <img onclick="deletImg(this)" src="./images/gb1.png" alt=""> -->
                        </div>
                        <div class="clrz-bg">
                            <div class="clrz-div">
                                <ul class="clrz-ul">
                                    <li class="pz"><input type="file" accept="image/*" mutiple="mutiple" capture="camera"
                                            onchange="checkImg(this)" /> <a>拍照</a> </li>
                                    <li class="xc"><input type="file" id="file" accept="image/*"
                                            onchange="checkImg(this)"><a>从相册选择</a></li>
                                </ul>
                                <a class="clrz-qx">取消</a>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
            <div class="car-button">
                <a class="tg">跳过</a>
                <a class="tj">提交</a>
            </div>
        </div>
    </div>
</body>

</html>
<script>
    // 返回
    $('.nav a img').click(function () {
        window.history.go(-1)
    })
    var file = document.querySelector('#file');
    if (getIos()) {
        file.removeAttribute("capture");
    }
    function getIos() {
        var ua = navigator.userAgent.toLowerCase();
        if (ua.match(/iPhone\sOS/i) == "iphone os") {
            return true;
        } else {
            return false;
        }
    }
    // 删除图片
    function deletImg(ele) {
        $(ele).parents(".video-center-nr").find('.video-center-img-box img').attr('src', './image/up-img.png');
        $(ele).parents(".video-center-nr").find('input').val("");
        $(ele).parents(".video-center-nr").removeClass('has');

    }
    // 选择图片后
    function checkImg(ele) {
        var fileType = verificationPicFile(ele);
        var fileType2 = verificationPicFile2(ele);
        if (fileType == 1 && fileType2 == 1) {
            showImg(ele);
        } else {
            deletImg(ele);
        }
        
        $('.clrz-bg').hide()
    }

    // 显示预览图片
    function showImg(ele) {
        console.log(ele)
        var file = $(ele)[0].files[0];    //获取文件信息
        var imgdata = '';
        if (file) {
            var reader = new FileReader();  //调用FileReader
            reader.readAsDataURL(file); //将文件读取为 DataURL(base64)
            reader.onload = function (evt) {   //读取操作完成时触发。
                $(ele).parents(".clrz-bg").prev().children('img:first-child').attr('src', evt.target.result)  //将img标签的src绑定为DataURL
                // $(ele).parents(".video-center-nr").addClass('has');
                $(ele).parents(".clrz-bg").prev().children('.img-sc').hide()
            };
        }
        else {
            alert("上传失败");
        }
    }
    //图片大小验证
    function verificationPicFile2(file) {
        var fileSize = 0;
        var fileMaxSize = 10240;//10M
        var filePath = file.value;
        if (filePath) {
            fileSize = file.files[0].size;
            var size = fileSize / 1024;
            if (size > fileMaxSize) {
                alert("文件大小不能大于10M！");
                file.value = "";
                return -1;
            } else if (size <= 0) {
                alert("文件大小不能为0M！");
                file.value = "";
                return -2;
            } else {
                return 1;
            }
        } else {
            return 0;
        }
    }
    //图片类型验证
    function verificationPicFile(file) {
        var fileTypes = [".jpg", ".png"];
        var filePath = file.value;
        //当括号里面的值为0、空字符、false 、null 、undefined的时候就相当于false
        if (filePath) {
            var isNext = false;
            var fileEnd = filePath.substring(filePath.indexOf("."));
            for (var i = 0; i < fileTypes.length; i++) {
                if (fileTypes[i] == fileEnd) {
                    isNext = true;
                    break;
                }
            }
            if (!isNext) {
                alert('不接受此文件类型');
                file.value = "";
                return -1; // 不接受此文件类型
            } else {
                return 1; //正确
            }
        } else {
            return 0; // 未选择图片
        }
    }
    $('.upload-div').click(function () {
        $(this).next().show()
    })
    $('.clrz-qx').click(function () {
        $(this).parents('.clrz-bg').hide()
    })
</script>